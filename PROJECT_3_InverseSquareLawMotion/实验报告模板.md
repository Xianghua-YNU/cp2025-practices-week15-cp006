# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** [在此处填写你的姓名]
**学号：** [在此处填写你的学号]
**完成日期：** [在此处填写完成日期]

## 1. 实验目的

（请用1-2句话简要描述本次实验你希望达成的学习目标，例如：通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性，并验证能量守恒和角动量守恒。）

## 2. 核心算法与实现

### 2.1 运动方程与数值方法
（简要说明你所使用的运动方程（例如，直角坐标系下的二阶微分方程组）以及你选择的数值求解方法，如 `scipy.integrate.solve_ivp` 及其参数设置，或自行实现的算法如龙格-库塔法等。）

### 2.2 关键函数实现思路
（选择1-2个你认为最核心的函数，例如 `derivatives` 或 `solve_orbit`，用3-5句话描述其实现思路和关键步骤。）

#### `[函数名1]` 实现思路：

```python
# 在此处粘贴你的核心代码片段 (5-10行)
# 例如 derivatives 函数的核心计算部分
```

#### `[函数名2]` 实现思路：

```python
# 在此处粘贴你的核心代码片段 (5-10行)
# 例如 solve_orbit 函数调用 solve_ivp 的部分
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

（在此处展示并分析你针对任务 A 生成的轨道图像。确保图像清晰，包含必要的标签和图例。）

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**

![image](https://github.com/user-attachments/assets/965c5059-4abe-4936-9a12-22d939befd88)

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了三种能量条件下的轨道：
 - 椭圆轨道 (E = [具体值]): [简要描述形状和特征]
 - 抛物线轨道 (E = [具体值]): [简要描述形状和特征]
 - 双曲线轨道 (E = [具体值]): [简要描述形状和特征]
 中心天体位于原点。
 图像文件名：energy_orbits.png (示例)
]
```

**结果分析：**
（简要分析不同能量条件下轨道形状的差异及其物理意义。可以讨论能量与轨道是否束缚的关系。）
当总能量E<0时，轨道为束缚态的椭圆，质点始终围绕中心天体运动；E=0时，轨道为抛物线，质点恰好能运动到无穷远处；E>0时，轨道为双曲线，质点具有足够能量逃逸。能量的正负直接决定了轨道是否束缚。
**(可选) 能量与角动量守恒验证：**
（如果你进行了能量和角动量随时间变化的计算和绘图，请在此处展示结果，并分析其守恒情况。讨论数值误差对守恒性的影响。）
通过计算并绘制能量和角动量随时间的变化曲线，发现能量和角动量在数值误差范围内保持恒定。数值误差导致守恒量存在微小波动，可通过减小步长或提高求解精度降低误差。
### 3.2 不同角动量下的椭圆轨道 (E < 0)

（在此处展示并分析你针对任务 B 生成的轨道图像。）
Demonstrating orbital simulations...
Ellipse: Initial E = -0.680, Initial Lz = 0.800
Ellipse: Final E = -0.680, Final Lz = 0.800 (Energy/Ang. Mom. Conservation Check)
Parabola: Initial E = 0.000
Hyperbola: Initial E = 0.440

Demonstrating varying angular momentum for E < 0...
For E_target=-0.2 at r0=1.5, required speed v0=0.966
  Angle 90deg: Calculated E=-0.200 (Target E=-0.200), Lz=1.449
  Angle 60deg: Calculated E=-0.200 (Target E=-0.200), Lz=1.255
  Angle 45deg: Calculated E=-0.200 (Target E=-0.200), Lz=1.025
**图2：固定能量 (E=[具体值])，不同角动量下的椭圆轨道**

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了能量 E=[具体值] 时，三个不同角动量 L1, L2, L3 下的椭圆轨道。
 - L1 = [值]: [描述轨道形状，如偏心率]
 - L2 = [值]: [描述轨道形状]
 - L3 = [值]: [描述轨道形状]
 图像文件名：angular_momentum_orbits.png (示例)
]
```

**结果分析：**
（分析角动量大小对椭圆轨道形状（如偏心率、半长轴、半短轴）的影响。角动量如何改变轨道的“扁平”程度？）

4.1遇到的主要问题及解决方法
 
问题1： 初始条件设置不当导致轨道不收敛。
解决方法： 查阅资料并多次调整初始位置和速度参数，通过试错法找到合适的初始条件组合，使轨道符合预期形状。
 
问题2： 数值解存在较大误差，能量不守恒。
解决方法： 调整  solve_ivp  中的  atol  和  rtol  参数，减小误差容限，提高求解精度，使能量在可接受误差范围内守恒。
 
4.2 主要收获与体会
 
通过本次实验，深入理解了平方反比引力场中轨道特性与能量、角动量的关系，掌握了将二阶微分方程转化为一阶方程组并利用数值方法求解的技能，同时提升了数据可视化和误差分析的能力，对理论知识在实际问题中的应用有了更深刻的认识。
 
5. 思考与展望
 
5.1 坐标转换与对称性
 
研究极坐标转换后发现，极坐标下的运动方程更直观地体现了轨道的对称性，可更方便地分析轨道的近心点和远心点。同时，利用对称性可简化计算过程，提高求解效率。
 
5.2 其他思考
 
此模型假设中心天体静止且仅存在单一引力，与真实天体运动存在差异。可通过引入多体问题、考虑相对论效应等方式改进模型。未来可以进一步研究天体相互作用对轨道的影响，使模型更接近实际情况

